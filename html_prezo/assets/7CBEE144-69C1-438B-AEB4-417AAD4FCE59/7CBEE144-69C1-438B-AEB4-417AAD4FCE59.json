{"assets":{"84DD01FE88F71337D988FCAA3E7B6279":{"type":"texture","index":40,"assetRequest":{"type":"slide","state":"incoming","slide":"BD0CA791-8DA1-4D63-85FF-7C31DB5B7361"},"url":"assets/84DD01FE88F71337D988FCAA3E7B6279.svg","width":1024,"height":768},"4A7147C4DFEEB6BCA3E778F805BB72A9":{"type":"texture","index":39,"assetRequest":{"type":"slide","state":"outgoing","slide":"7CBEE144-69C1-438B-AEB4-417AAD4FCE59"},"url":"assets/4A7147C4DFEEB6BCA3E778F805BB72A9.svg","width":1024,"height":768}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":true,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.0004922987690640373,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":15,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"84DD01FE88F71337D988FCAA3E7B6279"},{"animations":[{"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","duration":0.01,"to":{"scalar":true}}],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"4A7147C4DFEEB6BCA3E778F805BB72A9"}]}]},"effects":[],"duration":0.01,"type":"transition","name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"Avoiding stuff like this is where RGeo shows its benefits…","targetRectangle":{"y":575.1210021972656,"x":151.7520063323975,"width":720.4959999999999,"height":34}},{"text":"but you only need to do it once!","targetRectangle":{"y":609.1210021972656,"x":313.5640063323974,"width":396.8719999999999,"height":34}},{"text":"CREATE FUNCTION update_tweet_geom() RETURNS trigger","targetRectangle":{"y":242.5000038146973,"x":14.80809783935547,"width":675.5009765625,"height":25}},{"text":"    LANGUAGE plpgsql","targetRectangle":{"y":267.5000038146973,"x":14.80809783935547,"width":264.90234375,"height":25}},{"text":"    AS $$","targetRectangle":{"y":292.5000038146973,"x":14.80809783935547,"width":119.2060546875,"height":25}},{"text":"        BEGIN","targetRectangle":{"y":317.5000038146973,"x":14.80809783935547,"width":172.1865234375,"height":25}},{"text":"          NEW.geom := ST_GeomFromEWKT('SRID=3857;POINT (' || NEW.lng || ' ' || NEW.lat || ')');","targetRectangle":{"y":342.5000038146973,"x":14.80809783935547,"width":1006.62890625,"height":50}},{"text":"          RETURN NEW;","targetRectangle":{"y":392.5000038146973,"x":14.80809783935547,"width":278.1474609375,"height":25}},{"text":"        END;","targetRectangle":{"y":417.5000038146973,"x":14.80809783935547,"width":158.94140625,"height":25}},{"text":"      $$;","targetRectangle":{"y":442.5000038146973,"x":14.80809783935547,"width":119.2060546875,"height":25}},{"text":"CREATE TRIGGER trigger_update_geom_on_tweet_update ","targetRectangle":{"y":492.5000038146973,"x":14.80809783935547,"width":675.5009765625,"height":25}},{"text":"BEFORE INSERT OR UPDATE ON tweets ","targetRectangle":{"y":517.5000038146973,"x":14.80809783935547,"width":450.333984375,"height":25}},{"text":"FOR EACH ROW EXECUTE PROCEDURE update_tweet_geom();","targetRectangle":{"y":542.5000038146973,"x":14.80809783935547,"width":675.5009765625,"height":25}},{"text":"…add a Trigger (sorry) to keep the Geom column in sync with the lat/lng columns","targetRectangle":{"y":40,"x":96.93223437500001,"width":718.7927999999999,"height":162}},{"text":"pasted-image.png","targetRectangle":{"y":23.62100219726562,"x":821.501220703125,"width":161.9987487792969,"height":192.7579956054688}},{"text":"As Scott pointed out, you could do this via an #after_save callback, but the trigger approach covers the case of mass data imports separate from your app, which is a common thing to do when working with geo data.","targetRectangle":{"y":655.6210023164749,"x":57.17441778564455,"width":894.115171875,"height":87}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":true,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.0004922987690640373,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":15,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"4A7147C4DFEEB6BCA3E778F805BB72A9"}]}]}}]}